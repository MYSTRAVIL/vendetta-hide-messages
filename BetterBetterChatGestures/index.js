(function(S,s,e,C,t,m,V,r,h,G){"use strict";var l={Failed:r.getAssetIDByName("Small"),Delete:r.getAssetIDByName("ic_message_delete"),Copy:r.getAssetIDByName("toast_copy_link"),Open:r.getAssetIDByName("ic_leave_stage"),Clipboard:r.getAssetIDByName("pending-alert"),Clock:r.getAssetIDByName("clock"),Forum:r.getAssetIDByName("ic_forum_channel"),Settings:{Toasts:{Settings:r.getAssetIDByName("ic_selection_checked_24px"),Failed:r.getAssetIDByName("ic_close_circle_24px")},Initial:r.getAssetIDByName("coffee"),Update:r.getAssetIDByName("discover"),Locale:r.getAssetIDByName("ic_locale_24px"),External:r.getAssetIDByName("ic_raised_hand_list"),Edit:r.getAssetIDByName("ic_edit_24px"),Reply:r.getAssetIDByName("ic_reply_24px")}},f={shadow:function(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:.1;return{shadowColor:"#000",shadowOffset:{width:1,height:4},shadowOpacity:n,shadowRadius:4.65,elevation:8}},displayToast:function(n,a){e.toasts.open({content:a=="clipboard"?`Copied ${n} to clipboard.`:n,source:a=="clipboard"?l.Clipboard:l.Settings.Initial})}},v={plugin:{source:"https://github.com/MYSTRAVIL/vendetta-plugins"},author:{profile:{"Rosie<3":"https://github.com/acquitelol"}}};const{TouchableOpacity:D,View:P,Image:Y,Text:_,Animated:T}=m.General,N=s.findByProps("transitionToGuild"),L=s.findByStoreName("UserStore"),j=s.findByProps("showUserProfile"),c=e.stylesheet.createThemedStyleSheet({container:{marginTop:25,marginLeft:"5%",marginBottom:-15,flexDirection:"row"},textContainer:{paddingLeft:15,paddingTop:5,flexDirection:"column",flexWrap:"wrap",...f.shadow()},image:{width:75,height:75,borderRadius:10,...f.shadow()},mainText:{opacity:.975,letterSpacing:.25},header:{color:h.semanticColors.HEADER_PRIMARY,fontFamily:e.constants.Fonts.DISPLAY_BOLD,fontSize:25,letterSpacing:.25},subHeader:{color:h.semanticColors.HEADER_SECONDARY,fontSize:12.75}});function k(n){let{name:a,authors:p}=n;const o=e.React.useRef(new T.Value(1)).current,g=function(){return T.spring(o,{toValue:1.1,duration:10,useNativeDriver:!0}).start()},i=function(){return T.spring(o,{toValue:1,duration:250,useNativeDriver:!0}).start()},E=function(){return j.showUserProfile({userId:L.getCurrentUser().id})},b={transform:[{scale:o}]};return e.React.createElement(e.React.Fragment,null,e.React.createElement(P,{style:c.container},e.React.createElement(D,{onPress:E,onPressIn:g,onPressOut:i},e.React.createElement(T.View,{style:b},e.React.createElement(Y,{style:[c.image],source:{uri:L?.getCurrentUser()?.getAvatarURL()?.replace("webp","png")}}))),e.React.createElement(P,{style:c.textContainer},e.React.createElement(D,{onPress:function(){return N.openURL(v.plugin.source)}},e.React.createElement(_,{style:[c.mainText,c.header]},a)),e.React.createElement(P,{style:{flexDirection:"row"}},e.React.createElement(_,{style:[c.mainText,c.subHeader]},"A project by"),p.map(function(y,I,u){return e.React.createElement(D,{onPress:function(){return N.openURL(v.author.profile[y.name]??"https://github.com/")}},e.React.createElement(_,{style:[c.mainText,c.subHeader,{paddingLeft:4,fontFamily:e.constants.Fonts.DISPLAY_BOLD,flexDirection:"row"}]},y.name,I<u.length-1?",":null))})))))}const{View:K,Text:W}=m.General,O=e.stylesheet.createThemedStyleSheet({text:{color:h.semanticColors.HEADER_SECONDARY,paddingLeft:"5.5%",paddingRight:10,marginBottom:10,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:12}});function U(n){let{label:a,children:p}=n;return e.React.createElement(K,{style:{marginTop:10}},e.React.createElement(W,{style:[O.text,O.optionText]},a.toUpperCase()),p)}const{FormRow:d,FormSwitch:w,FormDivider:A,FormInput:z,FormText:q}=m.Forms,{ScrollView:X,View:B,Text:J}=m.General,Q=s.findByProps("transitionToGuild","openURL"),R=e.stylesheet.createThemedStyleSheet({icon:{color:h.semanticColors.INTERACTIVE_NORMAL},item:{color:h.semanticColors.TEXT_MUTED,fontFamily:e.constants.Fonts.PRIMARY_MEDIUM},container:{width:"90%",marginLeft:"5%",borderRadius:10,backgroundColor:h.semanticColors.BACKGROUND_MOBILE_SECONDARY,...f.shadow()},subheaderText:{color:h.semanticColors.HEADER_SECONDARY,textAlign:"center",margin:10,marginBottom:50,letterSpacing:.25,fontFamily:e.constants.Fonts.PRIMARY_BOLD,fontSize:14},image:{width:"100%",maxWidth:350,borderRadius:10}});function Z(){V.useProxy(t.storage);const n=e.ReactNative.Platform.OS==="android";return e.React.createElement(X,null,e.React.createElement(k,{name:t.manifest.name,authors:t.manifest.authors}),e.React.createElement(B,{style:{marginTop:20}},e.React.createElement(U,{label:"Preferences"},e.React.createElement(B,{style:[R.container]},e.React.createElement(d,{label:"Tap Username to Mention",subLabel:`Allows you to tap on a username to mention them instead of opening their profile.${n?"This option is disabled on Android.":""}`,onLongPress:function(){return f.displayToast("By default, Discord opens a profile when tapping on a username in chat. With this, it now mentions them, like on Android.","tooltip")},leading:e.React.createElement(d.Icon,{style:R.icon,source:t.storage.tapUsernameMention?l.Forum:l.Failed}),trailing:e.React.createElement(w,{value:n?!1:t.storage.tapUsernameMention,onValueChange:function(){n||(t.storage.tapUsernameMention=!t.storage.tapUsernameMention)}}),disabled:n}),e.React.createElement(A,null),e.React.createElement(d,{label:"Double Tap To Reply",subLabel:"Allows you to tap double tap on any messages to reply to them.",onLongPress:function(){return f.displayToast("When double tapping on any messages, you can now reply to them!","tooltip")},leading:e.React.createElement(d.Icon,{style:R.icon,source:t.storage.reply?l.Settings.Reply:l.Failed}),trailing:e.React.createElement(w,{value:t.storage.reply,onValueChange:function(){t.storage.reply=!t.storage.reply}})}),e.React.createElement(A,null),e.React.createElement(d,{label:`${t.storage.userEdit?"Editing":"Replying to"} your own messages`,subLabel:`Allows you to tap double tap on any of your own messages to ${t.storage.userEdit?"reply to":"edit"} them.`,onLongPress:function(){return f.displayToast(`When double tapping on any of your own messages, you can now ${t.storage.userEdit?"start an edit":"reply to them"}!`,"tooltip")},leading:e.React.createElement(d.Icon,{style:R.icon,source:t.storage.userEdit?l.Settings.Edit:l.Settings.Reply}),trailing:e.React.createElement(w,{value:t.storage.userEdit,onValueChange:function(){t.storage.userEdit=!t.storage.userEdit}})}),e.React.createElement(A,null),e.React.createElement(z,{value:t.storage.delay,onChange:function(a){t.storage.delay=a},placeholder:"300",title:"Maximum Delay"}),e.React.createElement(A,null),e.React.createElement(q,{style:{padding:10}},"The maximum delay between taps until the double tap event is cancelled. This is 300ms by default."))),e.React.createElement(U,{label:"Source"},e.React.createElement(B,{style:R.container},e.React.createElement(d,{label:"Source",subLabel:`Open the repository of ${t.manifest.name} externally.`,onLongPress:function(){return f.displayToast(`Opens the repository of ${t.manifest.name} on GitHub in an external page to view any source code of the plugin.`,"tooltip")},leading:e.React.createElement(d.Icon,{style:R.icon,source:l.Open}),trailing:function(){return e.React.createElement(d.Arrow,null)},onPress:function(){return Q.openURL(v.plugin.source)}})))),e.React.createElement(J,{style:R.subheaderText},`Build: (${t.manifest.hash.substring(0,8)})`))}const F=s.findByProps("insertText"),ee=s.findByStoreName("ChannelStore"),$=s.findByStoreName("MessageStore"),M=s.findByStoreName("UserStore"),te=s.findByProps("sendMessage","startEditMessage"),H=s.findByProps("createPendingReply"),{MessagesHandlers:x}=s.findByProps("MessagesHandlers"),ae={unpatchGetter:null,unpatchHandlers:null,currentTapIndex:0,currentMessageAuthor:null,doubleTapState(n){let{state:a="UNKNOWN",nativeEvent:p}=n;const o={state:a,data:p};return a=="INCOMPLETE"&&Object.assign(o,{reason:{required:{taps:2,isAuthor:!0},received:{taps:o.data.taps,isAuthor:o.data.isAuthor}}}),t.manifest.authors.find(function(g){return g.id===M.getCurrentUser().id})?console.log("DoubleTapState",o):void 0},patchHandlers(n){var a=this;if(n.__bcg_patched)return;n.__bcg_patched=!0;let p=Boolean(n.handleTapUsername)&&e.ReactNative.Platform.OS!=="android"&&C.instead("handleTapUsername",n,function(g,i){if(!t.storage.tapUsernameMention)return i.apply(a,g);const E=F.refs[0].current,{messageId:b}=g[0].nativeEvent,y=$.getMessage(E.props?.channel?.id,b);y&&F.insertText(`@${y.author.username}#${y.author.discriminator}`)}),o=Boolean(n.handleTapMessage)&&C.after("handleTapMessage",n,function(g){const{nativeEvent:i}=g[0],E=i.channelId,b=i.messageId;a.currentTapIndex++;let y=setTimeout(function(){a.currentTapIndex=0,a.currentMessageAuthor=null},Number(t.storage.delay));const I=ee.getChannel(E),u=$.getMessage(E,b);if(a.currentTapIndex===1&&(a.currentMessageAuthor=u.author.id),Object.assign(i,{taps:a.currentTapIndex,content:u?.content,authorId:u?.author?.id,isAuthor:u?.author?.id===M.getCurrentUser()?.id}),a.currentTapIndex!==2||a.currentMessageAuthor!==u.author.id)return a.doubleTapState({state:"INCOMPLETE",nativeEvent:i});if(clearTimeout(y),i?.authorId===M.getCurrentUser()?.id){if(t.storage.userEdit){const ne=i.content;te.startEditMessage(E,b,ne)}else H.createPendingReply({channel:I,message:u,shouldMention:!0});s.findByProps("openSystemKeyboard").openSystemKeyboardForLastCreatedInput();return}t.storage.reply&&(H.createPendingReply({channel:I,message:u,shouldMention:!0}),s.findByProps("openSystemKeyboard").openSystemKeyboardForLastCreatedInput()),a.currentTapIndex=0,a.currentMessageAuthor=null,a.doubleTapState({state:"COMPLETE",nativeEvent:i})});this.unpatchHandlers=function(){p&&p(),o&&o()}},onLoad(){G.logger.log("BetterChatGestures: storage.delay at ",t.storage.delay," with type ",typeof t.storage.delay),t.storage.tapUsernameMention??=e.ReactNative.Platform.select({android:!1,ios:!0,default:!0}),t.storage.reply??=!0,t.storage.userEdit??=!0,t.storage.delay??="300",t.storage.delay===""&&(t.storage.delay="300");const n=this,a=Object.getOwnPropertyDescriptor(x.prototype,"params").get;a&&Object.defineProperty(x.prototype,"params",{configurable:!0,get(){return this&&n.patchHandlers(this),a.call(this)}}),this.unpatchGetter=function(){a&&Object.defineProperty(x.prototype,"params",{configurable:!0,get:a})}},onUnload(){this.unpatchGetter?.(),this.unpatchHandlers?.()},settings:Z};return S.default=ae,Object.defineProperty(S,"__esModule",{value:!0}),S})({},vendetta.metro,vendetta.metro.common,vendetta.patcher,vendetta.plugin,vendetta.ui.components,vendetta.storage,vendetta.ui.assets,vendetta.ui,vendetta);
